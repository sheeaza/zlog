cur
per thread
    log
	r lock // for global config
	-> init set once thread local data.
	out log
		save to buf
		buf -> shared file
    
	unlock

	check if reload


new w thread

thread local data:
	thread const data, (pid, thread name
	per print:
		tmp store, func, file, line, level
    perf conf data:
        fifo buf

init 
    global config
    new rules

per thread
    log
	r lock // for global config
	-> init set once thread local data.
	if ver diff
		rebuild msgbuf, event
    cache func,file...,level to a_thread.event
	out log
        category for each rule
            save to buf
            sig -> wthread
            // buf -> shared file
    
	unlock

	check if reload global config

w thread:
    iter threads
        format log
        buf -> file
    check if reload config


category -> standlone, per print, shared by threads
    rule * n
